initState = [0.074941; -1.132446];

W_u = [0.63997 -0.21826 0.88730; 0.25009 0.11063 0.72248];
b_u = [0.051791; 0.479197];

W_g_in = [0.0099470 0.8399450 -0.2081483; 0.9820264 0.3257544 0.1064337];
b_g_in = [-0.515952; 0.055721];
W_g_h = [0.97504 0.35937; -0.37616 0.69398];
b_g_h = [0.60679; 0.44104];

W_a_in = [0.90352 0.25258 0.76472; 0.73948 0.98564 0.20552];
b_a_in = [-0.50516; 0.73835];
W_a_h = [0.26337 0.28690; -0.29784 -0.79788];
b_a_h = [-0.017014; 0.803208];

ins = [0.29989 0.37573 0.45905; 0.36990 0.29873 0.14858; 0.50296 0.22233 0.78369];

num = [0; 0];
denom = [0; 0];
h = tanh(initState);
for i=1:3
  input = ins(:,i);
  weights = exp(W_a_in*input + b_a_in + W_a_h*h + b_a_h);
  uOut = W_u*input + b_u;
  gOut = tanh(W_g_in*input + b_g_in + W_g_h*h + b_g_h);
  num += weights .* uOut .* gOut;
  denom += weights;
  h = tanh(num ./ denom)
end
